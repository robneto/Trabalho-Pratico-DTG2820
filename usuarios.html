<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Usuários de Teste via REST</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Vue 2 -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.7.14/dist/vue.min.js"></script>

  <style>
    body.bg-warning {
      min-height: 100vh;
      padding: 20px;
    }
    .user-card {
      width: 250px;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      margin-bottom: 18px;
    }
    .user-card img {
      height: 150px;
      object-fit: cover;
      border-top-left-radius: 12px;
      border-top-right-radius: 12px;
    }
    #usuarios .row { gap: 12px; }
  </style>
</head>
<body class="container bg-warning">
  <h1 class="mb-4">Usuários de Teste via REST</h1>

  <p>Dados obtidos de <a href="https://reqres.in" target="_blank" rel="noopener">reqres.in</a></p>

  <div id="usuarios" class="container-fluid">
    <div v-if="loading" class="mb-3">
      <div class="spinner-border" role="status" aria-hidden="true"></div>
      <span class="ms-2">Carregando usuários...</span>
    </div>

    <div v-if="error" class="alert alert-danger" role="alert">
      Erro ao carregar usuários: {{ error }}
    </div>

    <div class="row">
      <div class="card user-card p-2" v-for="(user, index) in users" :key="index">
        <img :src="user.avatar" :alt="user.first_name + ' ' + user.last_name" class="card-img-top">
        <div class="card-body">
          <h5 class="card-title">{{ user.first_name }} {{ user.last_name }}</h5>
          <p class="card-text">{{ user.email }}</p>
        </div>
      </div>
    </div>

    <div v-if="!loading && users.length === 0 && !error" class="mt-3">
      <small>Nenhum usuário encontrado.</small>
    </div>

    <div class="mt-4">
      <button class="btn btn-primary me-2" @click="loadUsers">Recarregar</button>
      <button class="btn btn-secondary" @click="clear">Limpar</button>
    </div>
  </div>

  <script>
    const app = new Vue({
      el: '#usuarios',
      data: function() {
        return {
          users: [],
          loading: false,
          error: null,
          apiUrl: 'https://reqres.in/api/users?per_page=10'
        };
      },
      mounted: function() {
        this.loadUsers();
      },
      methods: {
        loadUsers: function() {
            this.loading = true;
            this.error = null;

            fetch(this.apiUrl, {
                method: 'GET',
                headers: {
                'Content-Type': 'application/json',
                'x-api-key': 'reqres-free-v1' 
                }
            })
            .then(response => {
                if (!response.ok) throw new Error('HTTP ' + response.status);
                return response.json();
            })
            .then(json => {
                this.users = Array.isArray(json.data) ? json.data : [];
            })
            .catch(err => {
                console.error('Erro ao buscar usuários:', err);
                this.error = err.message || 'Erro desconhecido';
            })
            .finally(() => {
                this.loading = false;
            });
            },
        clear: function() {
          this.users = [];
          this.error = null;
        }
      }
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
